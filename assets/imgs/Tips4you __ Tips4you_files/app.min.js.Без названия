/**
 * @author    Daniil V. Deineko <contact@deineko.dev>
 * @copyright Copyright (c) 2017-2020
 */
let App=function(){"use strict";let t=this,n=new Ajax;t.popup=function(t=null,n,e,o){let i=void 0!==window.screenLeft?window.screenLeft:window.screenX,a=void 0!==window.screenTop?window.screenTop:window.screenY,r=(window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width)/2-e/2+i,l=(window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height)/2-o/2+a;return window[n]=window.open(t,n,"scrollbars=yes, width="+e+", height="+o+", top="+l+", left="+r)},t.modal=function(t,n=!1){let e=$("#public_modal");e.find(".modal-body:first").html(t),e.modal("show"),e.on("hidden.bs.modal",(function(){e.is(":not(:visible)")&&(e.find(".modal-body:first").empty(),n&&window.location.reload())}))},t.progress=function(t,e=null){let o=$("#progress-loader"),i=$("[type=submit]");null!==e&&o.on("click",(function(){e.focus()})),i.prop("disabled",!0),o.fadeIn(),$.when(t()).then((function(t,a,r){let l=setInterval((function(){(null===e||e.closed)&&(o.fadeOut(),clearInterval(l),i.prop("disabled",!1))}),1e3);n.catch(r)||null!==e&&!e.closed||(o.fadeOut(),i.prop("disabled",!1))}))},t.scroll=function(t,n=333,e="html, body"){$(e).stop().animate({scrollTop:$(t).offset().top-20},n)},t.plural=function(t,n){return t+" "+n[t%100>4&&t%100<20?2:[2,0,1,1,1,2][Math.min(t%10,5)]]},t.extend=function(t){$.extend(app,t)},t.href=function(){return"/"+Object.values(arguments).join("/")},t.randomize=function(t){let n=$(t).attr("data-pass-char").split(","),e="";$.inArray("a-z",n)>=0&&(e+="abcdefghijklmnopqrstuvwxyz"),$.inArray("A-Z",n)>=0&&(e+="ABCDEFGHIJKLMNOPQRSTUVWXYZ"),$.inArray("0-9",n)>=0&&(e+="0123456789"),$.inArray("#",n)>=0&&(e+="![]{}()%&*$#^<>~@|");let o="";for(let n=0;n<$(t).attr("data-pass-size");n++)o+=e.charAt(Math.floor(Math.random()*e.length));return o}},Ajax=function(){"use strict";let t=this;t.request=function(t="POST",n,e=window.location.href){return n instanceof FormData?$.ajax({url:e,type:t,data:n,dataType:"JSON",processData:!1,contentType:!1,cache:!1,async:!0}):$.ajax({url:e,type:t,data:n,dataType:"JSON",cache:!1,async:!0})},t.catch=function(t){return void 0!==t&&(void 0!==t&&void 0!==t.error?(alertify.notify(t.error,"error",5,(function(){console.log(t.error)})),!0):void 0)},t.getScript=async function(t){if(t)for(const n of t)await $.getScript(n)}};
/**
 * @author    Daniil V. Deineko <contact@deineko.dev>
 * @copyright Copyright (c) 2017-2020
 */$((function(){let t=$(this),n=new App,e=new Ajax;$("select:not(.default)").selectpicker({size:10,showSubtext:!0});Number.prototype.round=function(t){return+(Math.round(this+"e+"+t)+"e-"+t)},String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)},alertify.defaults={glossary:{title:null,ok:"Да",cancel:"Нет"},notifier:{position:"bottom-center",closeButton:!1,classes:{error:"alert alert-danger"}},theme:{input:"form-control",ok:"btn btn-primary",cancel:"btn btn-danger"},transition:"zoom"},$("[data-toggle=tooltip]").tooltip(),t.on("click",".gen-random-pass",(function(){let t=$(this).closest("div").find("input");t.val(n.randomize(t))})),t.on("hidden.bs.modal",(function(){$(".modal-backdrop").length>0&&$("body").addClass("modal-open")})),t.on("show.bs.modal",".modal",(function(t){let n=1040+10*$(".modal:visible").length;$(this).css("z-index",n),setTimeout((function(){$(".modal-backdrop").not(".modal-stack").css("z-index",n-1).addClass("modal-stack")}),0)})),app.user.auth&&(e.request("POST",null,"/auth/ajax/status"),setInterval((function(){e.request("POST",null,"/auth/ajax/status")}),3e4))}));
